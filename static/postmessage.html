<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>è¯·æ±‚é¡µé¢</title>
    <style>
        #child {
            border: 2px solid greenyellow;
            width: 500px;
            height: 200px;
            margin: 0 auto;
            text-align: center;
        }
        #father {
            border: 2px solid darkturquoise;
            width: 500px;
            height: 200px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
<div id="father">
    <p>è¿™é‡Œ7000ç«¯å£</p>
    <input type="text"/>
    <button>å‘é€ä¿¡æ¯</button>
    <p style="text-align: left;">message :  <span></span></p>
</div>

<pre>
åœ¨HTML5ä¸­æ–°å¢äº†postMessageæ–¹æ³•ï¼ŒpostMessageå¯ä»¥å®ç°è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ è¾“ï¼ˆCross Document Messagingï¼‰ï¼ŒInternet Explorer 8, Firefox 3, Opera 9, Chrome 3å’Œ Safari 4éƒ½æ”¯æŒpostMessageã€‚
è¯¥æ–¹æ³•å¯ä»¥é€šè¿‡ç»‘å®šwindowçš„messageäº‹ä»¶æ¥ç›‘å¬å‘é€è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ è¾“å†…å®¹ã€‚
ä½¿ç”¨postMessageå®ç°è·¨åŸŸçš„è¯åŸç†å°±ç±»ä¼¼äºjsonpï¼ŒåŠ¨æ€æ’å…¥iframeæ ‡ç­¾ï¼Œå†ä»iframeé‡Œé¢æ‹¿å›æ•°æ®


postMessageçš„ä½¿ç”¨æ–¹æ³•ï¼š
otherWindow.postMessage(message, targetOrigin);
otherWindow:æŒ‡ç›®æ ‡çª—å£ï¼Œä¹Ÿå°±æ˜¯ç»™å“ªä¸ªwindowå‘æ¶ˆæ¯ï¼Œæ˜¯ window.frames å±æ€§çš„æˆå‘˜æˆ–è€…ç”± window.open æ–¹æ³•åˆ›å»ºçš„çª—å£
message: æ˜¯è¦å‘é€çš„æ¶ˆæ¯ï¼Œç±»å‹ä¸º Stringã€Object (IE8ã€9 ä¸æ”¯æŒ)
targetOrigin: æ˜¯é™å®šæ¶ˆæ¯æ¥æ”¶èŒƒå›´ï¼Œä¸é™åˆ¶è¯·ä½¿ç”¨ '*
</pre>
<iframe id="child" src="http://localhost:7001/postmessage.html"></iframe>
<script>
    var input = document.getElementsByTagName('input')[0];
    var span = document.getElementsByTagName('span')[0];
    var btn = document.getElementsByTagName('button')[0];
    var frame = document.getElementById('child').contentWindow;

    btn.onclick = function () {
        var msg = input.value;
        frame.postMessage('æ”¶åˆ°ä¿¡æ¯ï¼š' + msg + ' --from 7000 portï¼ğŸ˜¨', 'http://localhost:7001');
    }

    function receiveMessage (event) {
        if (event.origin !== 'http://localhost:7001') {
            return false
        }
        var data = event.data;
        span.innerHTML = data;
    }

    window.addEventListener('message', receiveMessage, false);
</script>
</body>
</html>